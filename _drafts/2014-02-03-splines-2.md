---
layout: post
title: spline wiggles, part 2
tags: R
category: R
year: 2014
month: 2
day: 03
summary: spline-fit methods are compared on a difficult problem
description: spline-fit methods are compared on a difficult problem
---

# Introduction 

This follows up on the previous posting, using data provided by Akima (1970).

# Methods

First, create the data.

{% highlight r %} 
x1 <- c(0, 1, 2, 3, 4, 5, 6, 7,  8,  9, 10)
x2 <- c(0, 1, 3, 4, 6, 7, 8, 9, 10, 13, 15)
x3 <- c(0, 2, 3, 4, 6, 7, 8, 9, 10, 14, 15)
y <- c(10, 10, 10, 10, 10, 10, 10.5, 15, 50, 60, 85)
{% endhighlight %}

Next, plot the data.
{% highlight r %} 
if (!interactive()) png("splines2.png", width=7, height=4, unit="in", res=150, pointsize=8)
par(mar=c(3, 3, 1, 1), mgp=c(2, 0.7, 0), mfrow=c(1,3))
plot(x, y)
grid()
{% endhighlight %}

Using ``smooth.spline()``
{% highlight r %} 
d <- seq(min(x), max(x), length.out=100)
ss <- smooth.spline(y ~ x)
pss <- predict(ss, d)
lines(ps$x, ps$y)
s <- spline(x, y)
lines(s$x, s$y, col='blue')
{% endhighlight %}

Using ``aspline()``
{% highlight r %} 
library(akima)
akima <- aspline(x, y, d)
lines(akima$x, akima$y, col='red')
{% endhighlight %}

Finally, draw a legend and finish up.
{% highlight r %} 
legend("topleft", lwd=par('lwd'), bg='white',
       col=c("black", "red"),
       legend=c("smooth.spline", "aspline"))
if (!interactive()) dev.off()
{% endhighlight %}

# Results

[![graph]({{ site.url }}/assets/splines-thumbnail.png)]({{ site.url }}/assets/splines.png)

At least on this problem, ``aspline()`` does a much better job than ``smooth.spline()``.

# Citations

W. H. F. Smith and P. Wessel, 1990.  Gridding with continuous curvature splines in tension.  Geophysics, 55(3): 293-305.

Hiroshi Akima, 1970.  A new method of interpolation and smooth curve fitting based on local procedures.  Journal of the Association for Computing Machinery, 17(4): 589-602.
 

