<!DOCTYPE HTML>
<html>
<head>
<link rel='stylesheet' type='text/css' href='/css/syntax.css' />
<link rel='stylesheet' type='text/css' href='/css/style.css' />
<meta charset="UTF-8">
<title>landsat thermal imaging</title>
</head>

<body>
<div class="navbar">
    <!-- <div class="navbar-inner"> -->
        <!-- <a class="brand" href="/index.html">Dan Kelley</a> -->
        <!-- <div class="nav">Dan Kelley</div> -->
        <ul class="navbar">
            
            <li><a href="/index.html">Dan Kelley</a></li>
            

            
            <li><a href="/papers.html">Papers</a></li>
            

            
            <li><a href="/book.html">Book</a></li>
            

            
            <li><a href="/software.html">Software</a></li>
            
            
            <li><a class="highlight" href="/blog">Blog</a></li>
            

        </ul>
        <!-- </div> -->
</div>

<div id="content">
    
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>





<!-- <div class="span8"> -->

<div class=topnav>

<!-- | <a href='/blog'>Home</a> | -->

</div> <!-- topnav -->


<div class="page-header">

    <div class=post_title>landsat thermal imaging</div>
<!-- </div> --> <!-- span8 -->

<!-- <div class="span4"> -->

<div class=slug>
    <span class=post_date>
        
    </span> <!-- post_date -->
    <span class=post_tags>
        
        <a href="/tags/R/index.html" class="tag">
            R
        </a>
         &#183; 
        
        <a href="/tags/oce/index.html" class="tag">
            oce
        </a>
         &#183; 
        
        <a href="/tags/oceanography/index.html" class="tag">
            oceanography
        </a>
        
        
    </span> <!-- post_date -->
    <div class=post_summary>
        A landsat thermal image is constructed.
    </div> <!-- post_summary -->
</div> <!-- slug -->

<!-- </div> -->
<!-- span4 -->
</div> <!-- page-header -->



# Introduction

The ``tirs1`` band of landsat-8 imagery (see [1]) is a near-thermal band.  Here, algorithm (see [2]) is applied to estimate surface ``brightness temperature''.

# Methods

The brightness temperature in Kelvin is computed with $$T=K_2 / (ln(K_1/\lambda_L + 1)$$ where $$K_1$ and $$K_2$$ are stored in the image metadata, and $$\lambda_L=M_L*d+A_L$$, where again $$M_L$$ and $$A_L$$ are stored in the metadata.  In this last expression, $$d$$ is the image value, which when read with the ``oce`` package must be multiplied by $$2^15-1)$$.

Note in the code that the SST is computed in Celcius, and inserted into the data object before plotting.

```{r eval=FALSE}
library(oce)
l <- read.landsat("LC80080292014065LGN00", band="tirs1")
tirs1 <- l[["tirs1"]]
ML <- l@metadata$header$radiance_mult_band_10
AL <- l@metadata$header$radiance_add_band_10
K1 <- l@metadata$header$k1_constant_band_10
K2 <- l@metadata$header$k2_constant_band_10
d <- tirs1 * (2^16 - 1)            # convert from range 0 to 1
Llambda <- ML * d + AL
dd <- K2 / (log(K1 / Llambda + 1))
SST <- dd - 273.15                 # convert Kelvin to Celcius
l@data$SST <- SST
plot(l, band="SST", col=oceColorsJet)
mtext(l[["time"]])
```

# Results

The figure below shows the results.  This image is from winter, so the land (Nova Scotia) is colder than the ocean.  The high land is especially cold, as those familiar with the topography can tell at a glance.  Homogenous blue patches indicate frozen lakes.  Generally, the water temperature hovers around freezing (i.e. -2C).  Colder patches in the Bay of Fundy are likely a signature of ice.  Some of the orange colour suggests temperatures below freezing (perhaps 1C below), which suggests a difficulty in the algorithm or the interpretation.  Note the beautiful swirls in the ocean, particularly south of Nova Scotia, indicative of interesting flows.

![center](http://dankelley.github.io/figs/2014-07-01-landsat.png) 

# Resources

1. Landsat bands are explained at [http://landsat.gsfc.nasa.gov/?page_id=5377](http://landsat.gsfc.nasa.gov/?page_id=5377).

2. The conversion to brightness temperature is described at [http://landsat.usgs.gov/Landsat8_Using_Product.php](http://landsat.usgs.gov/Landsat8_Using_Product.php)

3. Source code: [2014-07-01-landsat.R](/assets/2014-07-01-landsat.R).



<div id="disqus_thread"></div>
<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'dankelleydalhousie'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
 var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
 dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
 (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
 })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</div>

<p class="footnote">This website is written in <a
href="http://jekyllrb.com">Jekyll</a>, and the source is available on <a
href="https://github.com/dankelley/dankelley.github.io">GitHub</a>.</p>

</body>
</html>

